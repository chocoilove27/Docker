# MCP Server é–‹ç™¼æŒ‡å—

é€™ä»½æ–‡ä»¶è¨˜éŒ„äº† MCP (Model Context Protocol) Server çš„é–‹ç™¼éç¨‹ã€æ¶æ§‹è¨­è¨ˆå’Œä½¿ç”¨æ–¹å¼ã€‚

## ğŸ“‹ ç›®éŒ„

- [ç’°å¢ƒè¨­å®š](#ç’°å¢ƒè¨­å®š)
- [å°ˆæ¡ˆæ¶æ§‹](#å°ˆæ¡ˆæ¶æ§‹)
- [å·¥å…·èªªæ˜](#å·¥å…·èªªæ˜)
- [é…ç½®ç®¡ç†](#é…ç½®ç®¡ç†)
- [å•Ÿå‹•æ–¹å¼](#å•Ÿå‹•æ–¹å¼)
- [Open WebUI æ•´åˆ](#open-webui-æ•´åˆ)
- [å¸¸è¦‹å•é¡Œ](#å¸¸è¦‹å•é¡Œ)
- [æœ€ä½³å¯¦è¸](#æœ€ä½³å¯¦è¸)

---

## ç’°å¢ƒè¨­å®š

### å®‰è£å¥—ä»¶

```bash
# MCP ç›¸é—œ
pip install mcp mcpo

# Open WebUI
pip install open-webui

# å…¶ä»–ä¾è³´
pip install psutil typing-extensions
```

### å•Ÿå‹•æŒ‡ä»¤

```bash
# MCP Server (é€é mcpo ä»£ç†)
mcpo --host 127.0.0.1 --port 9870 -- C:\Users\TZUYI.KUO\AppData\Local\anaconda3\envs\mcp\python.exe C:\Users\TZUYI.KUO\Downloads\çˆ¬èŸ²\mcp_modular\mcp_server_full_modular.py

# Open WebUI
open-webui serve
```

---

## å°ˆæ¡ˆæ¶æ§‹

### æ–¹æ¡ˆ 1ï¼šå–®ä¸€æ–‡ä»¶ (ç°¡å–®ç‰ˆ)

```
mcp/
â”œâ”€â”€ mcp_server_modular.py    # ä¸»ç¨‹å¼ï¼ˆæ‰€æœ‰å·¥å…·éƒ½å¯«åœ¨é€™è£¡ï¼‰
â””â”€â”€ config.json              # å·¥å…·é–‹é—œé…ç½®
```

**å„ªé»ï¼š**
- âœ… åªéœ€è¦ 2 å€‹æ–‡ä»¶
- âœ… æ˜“æ–¼éƒ¨ç½²
- âœ… é©åˆå°å‹å°ˆæ¡ˆï¼ˆ< 10 å€‹å·¥å…·ï¼‰

**ç¼ºé»ï¼š**
- âŒ å·¥å…·å¤šäº†ä¹‹å¾Œç¨‹å¼ç¢¼æœƒå¾ˆé•·
- âŒ ä¸æ˜“ç¶­è­·

### æ–¹æ¡ˆ 2ï¼šæ¨¡çµ„åŒ– (æ¨è–¦) â­

```
mcp_modular/
â”œâ”€â”€ mcp_server_full_modular.py    # ä¸»ç¨‹å¼ï¼ˆå‹•æ…‹è¼‰å…¥æ¨¡çµ„ï¼‰
â”œâ”€â”€ config.json                    # å·¥å…·é–‹é—œé…ç½®
â””â”€â”€ tools/                         # å·¥å…·æ¨¡çµ„ç›®éŒ„
    â”œâ”€â”€ __init__.py               # Python package æ¨™è¨˜ï¼ˆç©ºæ–‡ä»¶ï¼‰
    â”œâ”€â”€ system_info.py            # ç³»çµ±è³‡è¨Šå·¥å…·
    â”œâ”€â”€ cpu_monitor.py            # CPU ç›£æ§å·¥å…·
    â””â”€â”€ time_tool.py              # æ™‚é–“æŸ¥è©¢å·¥å…·
```

**å„ªé»ï¼š**
- âœ… ç¨‹å¼ç¢¼æ¨¡çµ„åŒ–ï¼Œæ˜“æ–¼ç¶­è­·
- âœ… å¯ä»¥è¼•é¬†æ–°å¢/ç§»é™¤å·¥å…·
- âœ… æ¯å€‹æ¨¡çµ„å°ˆæ³¨å–®ä¸€åŠŸèƒ½
- âœ… é©åˆåœ˜éšŠå”ä½œ

**ç¼ºé»ï¼š**
- âš ï¸ éœ€è¦å»ºç«‹ç›®éŒ„çµæ§‹
- âš ï¸ ç¨å¾®è¤‡é›œä¸€é»

### æ–¹æ¡ˆ 3ï¼šå¤š Server (ç¨ç«‹æ§åˆ¶)

```
standalone_servers/
â”œâ”€â”€ system_info_server.py      # Port 9870
â”œâ”€â”€ cpu_load_server.py         # Port 9871
â”œâ”€â”€ top_processes_server.py    # Port 9872
â”œâ”€â”€ time_server.py             # Port 9873
â””â”€â”€ start_all.bat              # æ‰¹æ¬¡å•Ÿå‹•è…³æœ¬
```

**å„ªé»ï¼š**
- âœ… åœ¨ Open WebUI ä¸­æ¯å€‹å·¥å…·æœ‰ç¨ç«‹é–‹é—œ
- âœ… å®Œå…¨ç¨ç«‹ï¼Œäº’ä¸å½±éŸ¿
- âœ… å¯ä»¥å–®ç¨å•Ÿå‹•/åœæ­¢æŸå€‹å·¥å…·

**ç¼ºé»ï¼š**
- âŒ éœ€è¦å¤šå€‹ Port
- âŒ ç®¡ç†è¤‡é›œåº¦é«˜
- âŒ è³‡æºæ¶ˆè€—è¼ƒå¤§

---

## å·¥å…·èªªæ˜

### 1. get_system_info

**åŠŸèƒ½ï¼š** å–å¾—å®Œæ•´çš„ç³»çµ±ç¡¬é«”å’Œä½œæ¥­ç³»çµ±è³‡è¨Š

**å›å‚³è³‡æ–™ï¼š**
- OS ç‰ˆæœ¬
- CPU å‹è™Ÿå’Œæ ¸å¿ƒæ•¸ï¼ˆå¯¦é«”/é‚è¼¯ï¼‰
- ç¸½è¨˜æ†¶é«”å®¹é‡
- ç£ç¢Ÿç©ºé–“å’Œä½¿ç”¨ç‡

**ä½¿ç”¨æ™‚æ©Ÿï¼š**
- æŸ¥è©¢ç³»çµ±è¦æ ¼
- "æˆ‘çš„é›»è…¦é…ç½®æ˜¯ä»€éº¼ï¼Ÿ"
- "æœ‰å¤šå°‘ RAMï¼Ÿ"
- "CPU æ˜¯ä»€éº¼å‹è™Ÿï¼Ÿ"

**ç¯„ä¾‹ï¼š**
```python
{
    "os": "Windows-10-10.0.19045-SP0",
    "system": "Windows",
    "cpu_model": "Intel(R) Core(TM) i7-9750H CPU @ 2.60GHz",
    "physical_cores": 6,
    "logical_cores": 12,
    "memory_gb": 16.0,
    "disks": [...]
}
```

### 2. get_cpu_load

**åŠŸèƒ½ï¼š** å–å¾—ç•¶å‰ CPU ä½¿ç”¨ç‡ï¼ˆå³æ™‚ç›£æ§ï¼‰

**åƒæ•¸ï¼š**
- `seconds`: æ¸¬é‡é–“éš”ï¼ˆé è¨­ 1 ç§’ï¼‰

**å›å‚³ï¼š** CPU ä½¿ç”¨ç‡ç™¾åˆ†æ¯” (0-100)

**ä½¿ç”¨æ™‚æ©Ÿï¼š**
- "ç¾åœ¨ CPU ä½¿ç”¨ç‡å¤šå°‘ï¼Ÿ"
- "CPU å¿™ä¸å¿™ï¼Ÿ"
- å³æ™‚ CPU è² è¼‰ç›£æ§

**ç¯„ä¾‹ï¼š**
```python
9.1  # è¡¨ç¤º 9.1% CPU ä½¿ç”¨ç‡
```

### 3. get_top_processes

**åŠŸèƒ½ï¼š** å–å¾—è¨˜æ†¶é«”ä½¿ç”¨é‡æœ€é«˜çš„å‰ N å€‹ç¨‹åº

**åƒæ•¸ï¼š**
- `n`: è¦å›å‚³çš„ç¨‹åºæ•¸é‡ï¼ˆé è¨­ 5ï¼‰

**å›å‚³ï¼š** ç¨‹åºåˆ—è¡¨ï¼ŒåŒ…å« PIDã€åç¨±ã€è¨˜æ†¶é«”ä½¿ç”¨é‡ã€CPU ä½¿ç”¨ç‡

**ä½¿ç”¨æ™‚æ©Ÿï¼š**
- "å“ªäº›ç¨‹å¼ä½”ç”¨æœ€å¤šè¨˜æ†¶é«”ï¼Ÿ"
- "é¡¯ç¤ºå‰ 10 å€‹ç¨‹åº"
- "ä»€éº¼ç¨‹å¼åœ¨åƒ RAMï¼Ÿ"

**ç¯„ä¾‹ï¼š**
```python
[
    {
        "pid": 1234,
        "name": "chrome.exe",
        "mem_mb": 1024.5,
        "cpu_percent": 5.2
    },
    ...
]
```

### 4. get_time

**åŠŸèƒ½ï¼š** å–å¾—ç•¶å‰æ—¥æœŸå’Œæ™‚é–“ï¼Œæ”¯æ´æ™‚å€è½‰æ›

**åƒæ•¸ï¼š**
- `tz`: IANA æ™‚å€å­—ä¸²ï¼ˆå¦‚ 'Asia/Taipei'ï¼‰
- `fmt`: strftime æ ¼å¼å­—ä¸²

**å›å‚³ï¼š** åŒ…å« ISO æ™‚é–“ã€æ ¼å¼åŒ–æ™‚é–“ã€epochã€æ™‚å€è³‡è¨Šç­‰

**ä½¿ç”¨æ™‚æ©Ÿï¼š**
- "ç¾åœ¨å¹¾é»ï¼Ÿ"
- "ä»Šå¤©æ—¥æœŸï¼Ÿ"
- "æ±äº¬ç¾åœ¨å¹¾é»ï¼Ÿ"
- æ™‚å€è½‰æ›

**ç¯„ä¾‹ï¼š**
```python
{
    "iso": "2025-11-06T09:30:00+08:00",
    "formatted": "2025-11-06 09:30:00+0800",
    "epoch": 1730856600.0,
    "tz": "CST",
    "date": "2025-11-06",
    "time": "09:30:00",
    "weekday": 3
}
```

---

## é…ç½®ç®¡ç†

### config.json æ ¼å¼

```json
{
  "tools": {
    "system_info": true,      // å•Ÿç”¨ç³»çµ±è³‡è¨Šå·¥å…·
    "cpu_load": true,          // å•Ÿç”¨ CPU è² è¼‰å·¥å…·
    "top_processes": true,     // å•Ÿç”¨ç¨‹åºåˆ—è¡¨å·¥å…·
    "host_info": false,        // åœç”¨ï¼ˆç›¸å®¹ç”¨ï¼‰
    "time": true               // å•Ÿç”¨æ™‚é–“å·¥å…·
  }
}
```

### é–‹é—œå·¥å…·

1. ç·¨è¼¯ `config.json`ï¼Œè¨­å®š `true`ï¼ˆå•Ÿç”¨ï¼‰æˆ– `false`ï¼ˆåœç”¨ï¼‰
2. é‡å•Ÿ MCP Server
3. è®Šæ›´ç«‹å³ç”Ÿæ•ˆ

**æ³¨æ„ï¼š** Open WebUI éœ€è¦é‡æ–°é€£ç·šæ‰èƒ½çœ‹åˆ°è®Šæ›´

---

## å•Ÿå‹•æ–¹å¼

### æ–¹æ¡ˆ 1 & 2ï¼šå–® Port å•Ÿå‹•

```bash
# å®Œæ•´æŒ‡ä»¤
mcpo --host 127.0.0.1 --port 9870 -- C:\Users\TZUYI.KUO\AppData\Local\anaconda3\envs\mcp\python.exe C:\Users\TZUYI.KUO\Downloads\çˆ¬èŸ²\mcp_modular\mcp_server_full_modular.py

# ç°¡åŒ–ç‰ˆï¼ˆå¦‚æœ python åœ¨ PATH ä¸­ï¼‰
mcpo --host 127.0.0.1 --port 9870 -- python mcp_server_full_modular.py
```

### æ–¹æ¡ˆ 3ï¼šå¤š Server å•Ÿå‹•

**Windows æ‰¹æ¬¡å•Ÿå‹•ï¼š**
```batch
start_all.bat
```

**æˆ–æ‰‹å‹•å•Ÿå‹•å„å€‹ Serverï¼š**
```bash
# System Info - Port 9870
mcpo --host 127.0.0.1 --port 9870 -- python system_info_server.py

# CPU Load - Port 9871
mcpo --host 127.0.0.1 --port 9871 -- python cpu_load_server.py

# Top Processes - Port 9872
mcpo --host 127.0.0.1 --port 9872 -- python top_processes_server.py

# Time Info - Port 9873
mcpo --host 127.0.0.1 --port 9873 -- python time_server.py
```

### é©—è­‰å•Ÿå‹•

åœ¨ç€è¦½å™¨è¨ªå•ï¼š
```
http://localhost:9870/docs
```

æ‡‰è©²æœƒçœ‹åˆ° Swagger UI é¡¯ç¤ºæ‰€æœ‰å¯ç”¨çš„å·¥å…·ã€‚

---

## Open WebUI æ•´åˆ

### æ–°å¢å¤–éƒ¨é€£ç·š

1. é€²å…¥ Open WebUI è¨­å®š
2. é¸æ“‡ã€Œå·¥å…·ã€â†’ã€Œå¤–éƒ¨é€£ç·šã€
3. é»æ“Šã€Œæ–°å¢é€£ç·šã€

### é€£ç·šè¨­å®š

**æ–¹æ¡ˆ 1 & 2ï¼ˆå–® Portï¼‰ï¼š**

| æ¬„ä½ | å€¼ |
|------|-----|
| é€£ç·šé¡å‹ | å¤–éƒ¨ |
| URL | `http://localhost:9870` |
| OpenAPI ä»‹é¢è¦ç¯„ | `openapi.json`ï¼ˆè‡ªå‹•ï¼‰ |
| é©—è­‰ | Bearerï¼ˆå¯ç•™ç©ºï¼‰ |

**æ–¹æ¡ˆ 3ï¼ˆå¤š Portï¼‰ï¼š**

éœ€è¦æ–°å¢ 4 å€‹é€£ç·šï¼š

| Server | URL |
|--------|-----|
| SystemInfo | `http://localhost:9870` |
| CPULoad | `http://localhost:9871` |
| TopProcesses | `http://localhost:9872` |
| TimeInfo | `http://localhost:9873` |

### Open WebUI é¡¯ç¤ºèªªæ˜

**é‡è¦æ¦‚å¿µï¼š**
- Open WebUI å°‡ã€Œä¸€å€‹ URLã€è¦–ç‚ºã€Œä¸€å€‹å·¥å…·ä¾†æºã€
- å–® Port æ–¹æ¡ˆåªæœƒé¡¯ç¤ºä¸€å€‹é–‹é—œï¼ˆå¦‚ "SystemInfoMCP"ï¼‰
- å¤š Port æ–¹æ¡ˆæœƒé¡¯ç¤ºå¤šå€‹é–‹é—œï¼ˆæ¯å€‹ Server ä¸€å€‹ï¼‰

**å¯¦éš›å·¥å…·ä½¿ç”¨ï¼š**
- å³ä½¿åªé¡¯ç¤ºä¸€å€‹é–‹é—œï¼ŒAI ä»æœƒæ ¹æ“šå•é¡Œè‡ªå‹•é¸æ“‡æ­£ç¢ºçš„å·¥å…·
- å·¥å…·çš„é¸æ“‡å–æ±ºæ–¼ description çš„æ¸…æ™°åº¦

---

## å¸¸è¦‹å•é¡Œ

### Q1: ç‚ºä»€éº¼ Open WebUI åªé¡¯ç¤ºä¸€å€‹å·¥å…·ï¼Ÿ

**A:** é€™æ˜¯ Open WebUI çš„è¨­è¨ˆã€‚ä¸€å€‹ URL é€£ç·š = ä¸€å€‹å·¥å…·ä¾†æºã€‚å¯¦éš›ä¸Šæœ‰å¤šå€‹ functionï¼Œä½†ä»‹é¢ä¸Šåªé¡¯ç¤ºä¸€å€‹é–‹é—œã€‚

**è§£æ±ºæ–¹æ¡ˆï¼š**
- æ¥å—ç¾ç‹€ï¼ˆæ¨è–¦ï¼‰- AI æœƒè‡ªå‹•é¸æ“‡æ­£ç¢ºçš„å·¥å…·
- æˆ–ä½¿ç”¨å¤š Port æ–¹æ¡ˆ - æ¯å€‹å·¥å…·ç¨ç«‹ Server

### Q2: AI æœƒä¸æœƒé¸éŒ¯å·¥å…·ï¼Ÿ

**A:** å¦‚æœ description å¯«å¾—æ¸…æ¥šï¼ŒAI å¾ˆå°‘é¸éŒ¯ã€‚

**æ”¹å–„æ–¹æ³•ï¼š**
- åœ¨ description ä¸­æ˜ç¢ºèªªæ˜ä½¿ç”¨æ™‚æ©Ÿ
- åˆ—å‡ºå¸¸è¦‹çš„ä½¿ç”¨è€…å•æ³•
- æ¸…æ¥šæè¿°åƒæ•¸å’Œå›å‚³å€¼

### Q3: é‡åˆ° UTF-8 ç·¨ç¢¼éŒ¯èª¤æ€éº¼è¾¦ï¼Ÿ

**A:** 
```
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa5
```

**åŸå› ï¼š** Python ç¨‹å¼ä¸­æœ‰ä¸­æ–‡è¼¸å‡ºï¼Œä½† mcpo æœŸæœ› UTF-8

**è§£æ±ºæ–¹æ³•ï¼š**
1. ç§»é™¤æ‰€æœ‰ä¸­æ–‡è¨»è§£å’Œ print èªå¥
2. æˆ–åœ¨ç¨‹å¼é–‹é ­åŠ ä¸Šï¼š
```python
import sys
sys.stdout.reconfigure(encoding='utf-8')
```

### Q4: æ²’æœ‰ pynvml æ¨¡çµ„æ€éº¼è¾¦ï¼Ÿ

**A:** å¦‚æœä¸éœ€è¦ GPU è³‡è¨Šï¼š

**æ–¹æ³• 1ï¼š** å®‰è£å¥—ä»¶
```bash
pip install pynvml
```

**æ–¹æ³• 2ï¼š** ç§»é™¤ GPU æª¢æ¸¬ç¨‹å¼ç¢¼
```python
# åˆªé™¤æˆ–è¨»è§£æ‰æ‰€æœ‰ pynvml ç›¸é—œç¨‹å¼ç¢¼
```

### Q5: config.json ä¿®æ”¹å¾Œæ²’æœ‰ç”Ÿæ•ˆï¼Ÿ

**æª¢æŸ¥æ¸…å–®ï¼š**
1. âœ… config.json åœ¨æ­£ç¢ºçš„ä½ç½®ï¼ˆèˆ‡ server.py åŒç›®éŒ„ï¼‰
2. âœ… JSON æ ¼å¼æ­£ç¢ºï¼ˆæ²’æœ‰å¤šé¤˜çš„é€—è™Ÿï¼‰
3. âœ… é‡å•Ÿäº† MCP Server
4. âœ… Open WebUI é‡æ–°é€£ç·š

### Q6: Port æ•¸é‡æœ‰é™åˆ¶å—ï¼Ÿ

**A:** 
- ç†è«–ä¸Šé™ï¼š65535 å€‹ Port
- å¯ç”¨ç¯„åœï¼š1024-65535
- å¯¦éš›é™åˆ¶ï¼šè¨˜æ†¶é«”å’Œç®¡ç†è¤‡é›œåº¦

**å»ºè­°ï¼š**
- ä¸è¦ä¸€å€‹å·¥å…·ç”¨ä¸€å€‹ Port
- æŒ‰åŠŸèƒ½é ˜åŸŸåˆ†çµ„ï¼ˆ5-20 å€‹ Server å°±å¤ äº†ï¼‰

### Q7: Open WebUI é¡¯ç¤ºã€Œé€£ç·šå¤±æ•—ã€ï¼Ÿ

**æ’æŸ¥æ­¥é©Ÿï¼š**

1. æª¢æŸ¥ MCP Server æ˜¯å¦å•Ÿå‹•ï¼š
```bash
# æ‡‰è©²çœ‹åˆ° "Uvicorn running on http://127.0.0.1:9870"
```

2. æ¸¬è©¦ API æ˜¯å¦å¯è¨ªå•ï¼š
```bash
curl http://localhost:9870/openapi.json
```

3. æª¢æŸ¥ Port æ˜¯å¦è¡çªï¼š
```bash
netstat -ano | findstr :9870
```

4. æª¢æŸ¥é˜²ç«ç‰†è¨­å®š

---

## æœ€ä½³å¯¦è¸

### 1. å·¥å…·è¨­è¨ˆåŸå‰‡

âœ… **å–®ä¸€è·è²¬**
- æ¯å€‹å·¥å…·åªåšä¸€ä»¶äº‹
- ä¸è¦æŠŠå¤šå€‹åŠŸèƒ½å¡åœ¨åŒä¸€å€‹å·¥å…·è£¡

âœ… **æ¸…æ™°çš„å‘½å**
- å·¥å…·åç¨±è¦æè¿°æ€§å¼·ï¼š`get_system_info` æ¯” `get_info` å¥½
- åƒæ•¸åç¨±è¦æ˜ç¢ºï¼š`seconds` æ¯” `s` å¥½

âœ… **è©³ç´°çš„ Description**
```python
@mcp.tool()
def get_cpu_load(seconds: int = 1) -> float:
    """Get current CPU usage percentage in real-time.
    
    Args:
        seconds: Measurement interval (default 1 second)
    
    Returns: CPU usage as a percentage (0-100)
    
    Use this tool when user asks about:
    - "What's the CPU usage right now?"
    - "How much CPU am I using?"
    - "Is my CPU busy?"
    """
```

### 2. æ¶æ§‹é¸æ“‡å»ºè­°

| å·¥å…·æ•¸é‡ | æ¨è–¦æ–¹æ¡ˆ | åŸå›  |
|---------|---------|------|
| 1-5 å€‹ | æ–¹æ¡ˆ 1ï¼ˆå–®æ–‡ä»¶ï¼‰ | ç°¡å–®ç›´æ¥ |
| 5-20 å€‹ | æ–¹æ¡ˆ 2ï¼ˆæ¨¡çµ„åŒ–ï¼‰ | æ˜“æ–¼ç¶­è­· |
| 20+ å€‹ | æ–¹æ¡ˆ 2 + åˆ†çµ„ | æŒ‰åŠŸèƒ½é ˜åŸŸåˆ†çµ„ |
| éœ€è¦ç²¾ç¢ºæ§åˆ¶ | æ–¹æ¡ˆ 3ï¼ˆå¤š Serverï¼‰ | æ¯å€‹å·¥å…·ç¨ç«‹é–‹é—œ |

### 3. éŒ¯èª¤è™•ç†

```python
@mcp.tool()
def get_system_info() -> SysInfo:
    """Get system configuration"""
    try:
        # ä¸»è¦é‚è¼¯
        result = do_something()
        return result
    except PermissionError:
        # è™•ç†ç‰¹å®šéŒ¯èª¤
        return {"error": "Permission denied"}
    except Exception as e:
        # è™•ç†ä¸€èˆ¬éŒ¯èª¤
        return {"error": str(e)}
```

### 4. æ•ˆèƒ½è€ƒé‡

âš¡ **å¿«é€Ÿå›æ‡‰**
- å·¥å…·åŸ·è¡Œæ™‚é–“æ‡‰ < 5 ç§’
- å¦‚æœéœ€è¦é•·æ™‚é–“é‹ç®—ï¼Œè€ƒæ…®éåŒæ­¥æˆ–åˆ†é 

âš¡ **è³‡æºä½¿ç”¨**
- é¿å…ä½”ç”¨å¤ªå¤šè¨˜æ†¶é«”
- é—œé–‰ä¸éœ€è¦çš„é€£ç·š

âš¡ **å¿«å–**
- å°æ–¼ä¸å¸¸è®Šå‹•çš„è³‡æ–™ï¼ˆå¦‚ç³»çµ±è³‡è¨Šï¼‰ï¼Œå¯ä»¥åŠ å…¥å¿«å–

### 5. å®‰å…¨æ€§

ğŸ”’ **è¼¸å…¥é©—è­‰**
```python
def get_top_processes(n: int = 5) -> list[dict]:
    # é©—è­‰åƒæ•¸ç¯„åœ
    n = max(1, min(n, 100))  # é™åˆ¶åœ¨ 1-100 ä¹‹é–“
    ...
```

ğŸ”’ **æ¬Šé™æ§åˆ¶**
- é¿å…åŸ·è¡Œå±éšªå‘½ä»¤
- é™åˆ¶æª”æ¡ˆå­˜å–ç¯„åœ

ğŸ”’ **éŒ¯èª¤è¨Šæ¯**
- ä¸è¦æ´©æ¼ç³»çµ±æ•æ„Ÿè³‡è¨Š
- éŒ¯èª¤è¨Šæ¯è¦æ¸…æ¥šä½†ä¸éåº¦è©³ç´°

### 6. æ¸¬è©¦å»ºè­°

âœ… **å–®å…ƒæ¸¬è©¦**
```python
def test_get_cpu_load():
    result = get_cpu_load(seconds=1)
    assert 0 <= result <= 100
    assert isinstance(result, float)
```

âœ… **æ•´åˆæ¸¬è©¦**
- å•Ÿå‹• MCP Server
- ç”¨ curl æ¸¬è©¦ API
- åœ¨ Open WebUI ä¸­å¯¦éš›ä½¿ç”¨

âœ… **è² è¼‰æ¸¬è©¦**
- æ¨¡æ“¬å¤šå€‹åŒæ™‚è«‹æ±‚
- ç¢ºä¿ Server ç©©å®š

---

## æª”æ¡ˆæ¸…å–®

### æ–¹æ¡ˆ 2 å®Œæ•´æ–‡ä»¶

```
mcp_modular/
â”œâ”€â”€ mcp_server_full_modular.py    # ä¸»ç¨‹å¼
â”œâ”€â”€ config.json                    # é…ç½®æ–‡ä»¶
â””â”€â”€ tools/
    â”œâ”€â”€ __init__.py               # Python packageï¼ˆç©ºæ–‡ä»¶ï¼‰
    â”œâ”€â”€ system_info.py            # ç³»çµ±è³‡è¨Šå·¥å…·
    â”œâ”€â”€ cpu_monitor.py            # CPU ç›£æ§å·¥å…·
    â””â”€â”€ time_tool.py              # æ™‚é–“å·¥å…·
```

### é—œéµç¨‹å¼ç¢¼ç‰‡æ®µ

**ä¸»ç¨‹å¼çµæ§‹ï¼š**
```python
# mcp_server_full_modular.py
from mcp.server.fastmcp import FastMCP
import importlib

# è¼‰å…¥é…ç½®
config = load_config()

# å»ºç«‹ Server
mcp = FastMCP("SystemInfoMCP")

# å‹•æ…‹è¼‰å…¥å·¥å…·æ¨¡çµ„
for tool_name, enabled in config["tools"].items():
    if enabled:
        module = importlib.import_module(f"tools.{module_name}")
        module.register_tools(mcp)

# å•Ÿå‹•
mcp.run()
```

**å·¥å…·æ¨¡çµ„çµæ§‹ï¼š**
```python
# tools/system_info.py
def register_tools(mcp):
    @mcp.tool()
    def get_system_info() -> dict:
        """Tool description"""
        # å¯¦ä½œé‚è¼¯
        return result
```

---

## å»¶ä¼¸é–±è®€

- [MCP å®˜æ–¹æ–‡ä»¶](https://modelcontextprotocol.io/)
- [FastMCP æ–‡ä»¶](https://github.com/jlowin/fastmcp)
- [Open WebUI æ–‡ä»¶](https://docs.openwebui.com/)
- [Claude Desktop MCP é…ç½®](https://docs.anthropic.com/claude/docs/model-context-protocol)

---

## ç‰ˆæœ¬è¨˜éŒ„

- **v1.0** (2025-11-06)
  - åˆå§‹ç‰ˆæœ¬
  - æ”¯æ´ 4 å€‹åŸºæœ¬å·¥å…·
  - æ¨¡çµ„åŒ–æ¶æ§‹
  - config.json é…ç½®ç®¡ç†
  - ç§»é™¤ GPU ä¾è³´
  - è§£æ±º UTF-8 ç·¨ç¢¼å•é¡Œ

---

## æˆæ¬Š

æœ¬å°ˆæ¡ˆç‚ºå­¸ç¿’å’Œé–‹ç™¼ç”¨é€”ï¼Œå¯è‡ªç”±ä¿®æ”¹å’Œä½¿ç”¨ã€‚

---

**æœ€å¾Œæ›´æ–°ï¼š** 2025-11-06  
**ç¶­è­·è€…ï¼š** TZUYI.KUO
